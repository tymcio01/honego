<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create New Offer - AutoOffer</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.17/jspdf.plugin.autotable.min.js"></script>
</head>

<body>
    <div class="container">
        <button onclick="location.href='dashboard.html'">Back to Dashboard</button>
        <h2>Create New Offer</h2>        
        <h3>Client Data</h3>
        <label for="clientName">Client Name/Company:</label>
        <input type="text" id="clientName" placeholder="Enter client name or company">
        <label for="clientAddress">Address:</label>
        <input type="text" id="clientAddress" placeholder="Enter address">
        <label for="clientEmail">Client Email:</label>
        <input type="email" id="clientEmail" placeholder="Enter client email">
        <label for="receiverName">Receiver's Name:</label>
        <input type="text" id="receiverName" placeholder="Enter receiver's name">

<h3>Reservation Dates</h3>
<div class="date-reservation">
  <div class="date-field">
    <label for="roomStartDate">Room Start Date:</label>
    <input type="date" id="roomStartDate" name="roomStartDate">
  </div>

  <div class="date-field">
    <label for="roomEndDate">Room End Date:</label>
    <input type="date" id="roomEndDate" name="roomEndDate">
  </div>
</div>

<h3>Meeting Room Reservation Dates</h3>
<div class="date-reservation">
  <div class="date-field">
    <label for="meetingRoomStartDate">Meeting Room Start Date:</label>
    <input type="date" id="meetingRoomStartDate" name="meetingRoomStartDate">
  </div>

  <div class="date-field">
    <label for="meetingRoomEndDate">Meeting Room End Date:</label>
    <input type="date" id="meetingRoomEndDate" name="meetingRoomEndDate">
  </div>
</div>
        <h3>Products/Services</h3>
        <div class="products-container">
            <div id="availableProducts" class="product-list" ondrop="drop(event)" ondragover="allowDrop(event)">
                <h4>Available Products</h4>
                <!-- Products will appear here -->
            </div>
            <div id="selectedProducts" class="product-list" ondrop="drop(event)" ondragover="allowDrop(event)">
                <h4>Selected Products</h4>
                <!-- Selected products will appear here -->
            </div>
        </div>

        <h3>Additional Notes & Conditions</h3>
        <textarea id="additionalNotes" rows="4" placeholder="Enter any additional notes and conditions"></textarea>

        <h3>Signature</h3>
        <input type="text" id="signature" value="Your Signature from Profile" readonly>

        <button onclick="saveDraft()">Save as Draft</button>
        <button>Preview</button>
        <button onclick="generatePDF()">Generate PDF</button>
        <button>Send by Email</button>
    </div>

    <script>
        function allowDrop(event) {
            event.preventDefault();
        }

        function drag(event) {
            event.dataTransfer.setData("text", event.target.id);
        }

        function doubleClickMove(event) {
            const productDiv = event.target.closest('.product');
            const targetList = productDiv.closest('#availableProducts') ? 'selectedProducts' : 'availableProducts';
            document.getElementById(targetList).appendChild(productDiv);
        }

        function drop(event) {
            event.preventDefault();
            var data = event.dataTransfer.getData("text");
            var droppedElement = document.getElementById(data);
            event.target.closest('.product-list').appendChild(droppedElement);
        }

        window.onload = function() {
            const availableProductsDiv = document.getElementById('availableProducts');
            const products = JSON.parse(localStorage.getItem('products')) || [];

            products.forEach((product, index) => {
                const productDiv = document.createElement('div');
                productDiv.className = 'product';
                productDiv.draggable = true;
                productDiv.ondragstart = drag;
                productDiv.id = 'product' + (index + 1);
                productDiv.innerHTML = `
                    <span>${product.name} - $${product.price}</span>
                    <div style="float:right;">
                        <button onclick="decreaseQuantity(this.parentElement.parentElement)">-</button>
                        <span class="quantity">1</span>
                        <button onclick="increaseQuantity(this.parentElement.parentElement)">+</button>
                    </div>
                `;
                availableProductsDiv.appendChild(productDiv);
            });
        };

        function increaseQuantity(productDiv) {
            let quantityDiv = productDiv.querySelector('.quantity');
            let quantity = parseInt(quantityDiv.innerText);
            quantityDiv.innerText = quantity + 1;
        }

        function decreaseQuantity(productDiv) {
            let quantityDiv = productDiv.querySelector('.quantity');
            let quantity = parseInt(quantityDiv.innerText);
            if (quantity > 1) {
                quantityDiv.innerText = quantity - 1;
            }
        }
    </script>
</body>

</html>